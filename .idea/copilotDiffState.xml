<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/SOLUCION_DEFINITIVA.bat">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SOLUCION_DEFINITIVA.bat" />
              <option name="updatedContent" value="@echo off&#10;echo ==========================================&#10;echo SOLUCION DEFINITIVA - ERROR GRADLE TASKS&#10;echo ==========================================&#10;cd /d &quot;%~dp0&quot;&#10;&#10;echo.&#10;echo Este script resolvera: &quot;Unable to find Gradle tasks to build&quot;&#10;echo.&#10;pause&#10;&#10;echo.&#10;echo [1/8] Cerrando Android Studio si esta abierto...&#10;echo Por favor, CIERRA Android Studio ahora si esta abierto.&#10;echo.&#10;pause&#10;&#10;echo.&#10;echo [2/8] Deteniendo procesos de Gradle...&#10;call gradlew.bat --stop&#10;timeout /t 3 /nobreak &gt; nul&#10;&#10;echo.&#10;echo [3/8] Eliminando cache del proyecto...&#10;if exist .gradle rmdir /s /q .gradle&#10;if exist .idea rmdir /s /q .idea&#10;if exist .kotlin rmdir /s /q .kotlin&#10;if exist build rmdir /s /q build&#10;if exist app\build rmdir /s /q app\build&#10;&#10;echo.&#10;echo [4/8] Eliminando archivos de configuracion del IDE...&#10;if exist *.iml del /q *.iml&#10;if exist app\*.iml del /q app\*.iml&#10;&#10;echo.&#10;echo [5/8] Limpiando con Gradle...&#10;call gradlew.bat clean&#10;&#10;echo.&#10;echo [6/8] Verificando estructura del proyecto...&#10;call gradlew.bat projects&#10;&#10;echo.&#10;echo [7/8] Listando tareas disponibles...&#10;call gradlew.bat tasks&#10;&#10;echo.&#10;echo [8/8] Compilando el proyecto...&#10;call gradlew.bat assembleDebug&#10;&#10;echo.&#10;echo ==========================================&#10;echo COMPLETADO!&#10;echo ==========================================&#10;echo.&#10;echo Ahora ABRE Android Studio y:&#10;echo 1. Abre este proyecto&#10;echo 2. File ^&gt; Sync Project with Gradle Files&#10;echo 3. Build ^&gt; Rebuild Project&#10;echo.&#10;echo El error deberia estar resuelto.&#10;echo ==========================================&#10;pause&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/appcolegios/admin/AdminUsersScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/appcolegios/admin/AdminUsersScreen.kt" />
              <option name="originalContent" value="package com.example.appcolegios.admin&#10;&#10;import androidx.navigation.NavController&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.MoreVert&#10;import androidx.compose.material.icons.filled.Notifications&#10;import androidx.compose.material.icons.filled.Event&#10;import androidx.compose.material.icons.filled.Schedule&#10;import com.google.firebase.firestore.FirebaseFirestore&#10;import com.google.firebase.Timestamp&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;import com.example.appcolegios.data.FirebaseRepository&#10;import kotlinx.coroutines.launch&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.TextButton&#10;import androidx.compose.material3.AlertDialog&#10;import androidx.compose.material3.Icon&#10;import com.example.appcolegios.academico.EventType&#10;import java.util.UUID&#10;import androidx.compose.runtime.rememberCoroutineScope&#10;import androidx.compose.ui.platform.LocalContext&#10;import android.widget.Toast&#10;import androidx.compose.material3.OutlinedTextField&#10;import kotlinx.coroutines.tasks.await&#10;&#10;@Composable&#10;fun AdminUsersScreen(navController: NavController? = null, mode: String = &quot;view&quot;, onUserSelected: (String) -&gt; Unit = {}) {&#10;    val db = FirebaseFirestore.getInstance()&#10;    val scope = rememberCoroutineScope()&#10;    val context = LocalContext.current&#10;    var users by remember { mutableStateOf&lt;List&lt;Map&lt;String, Any&gt;&gt;&gt;(emptyList()) }&#10;    var isLoading by remember { mutableStateOf(true) }&#10;    var error by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    // UI states for dialogs&#10;    var showDeleteConfirmUserId by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var showDeleteConfirmUserName by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    var composeNotificationForUserId by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var composeNotificationForUserName by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var notifTitle by remember { mutableStateOf(&quot;&quot;) }&#10;    var notifBody by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    LaunchedEffect(Unit) {&#10;        isLoading = true&#10;        try {&#10;            val repo = FirebaseRepository()&#10;            users = repo.fetchAdminUserList()&#10;        } catch (e: Exception) {&#10;            error = e.message&#10;        } finally {&#10;            isLoading = false&#10;        }&#10;    }&#10;&#10;    if (isLoading) {&#10;        Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) { CircularProgressIndicator() }&#10;        return&#10;    }&#10;    if (error != null) {&#10;        Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) { Text(&quot;Error: $error&quot;) }&#10;        return&#10;    }&#10;&#10;    Card(Modifier.fillMaxSize().padding(8.dp)) {&#10;        // Usar LazyColumn para lista; el contenido del card puede necesitar scroll vertical en pantallas pequeñas&#10;        LazyColumn(contentPadding = PaddingValues(8.dp)) {&#10;            items(users) { u -&gt;&#10;                val id = u[&quot;id&quot;] as? String ?: &quot;&quot;&#10;                val name = (u[&quot;displayName&quot;] as? String) ?: (u[&quot;name&quot;] as? String) ?: &quot;(sin nombre)&quot;&#10;                val email = (u[&quot;email&quot;] as? String) ?: &quot;&quot;&#10;                val role = (u[&quot;role&quot;] as? String) ?: &quot;&quot;&#10;                var actionsOpen by remember { mutableStateOf(false) }&#10;                Column(modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(vertical = 8.dp)&#10;                ) {&#10;                    Row(modifier = Modifier.fillMaxWidth(), verticalAlignment = Alignment.CenterVertically) {&#10;                        Column(modifier = Modifier.weight(1f).clickable {&#10;                            // navegar a detalle de perfil&#10;                            navController?.navigate(com.example.appcolegios.navigation.AppRoutes.AdminProfileDetail.route.replace(&quot;{userId}&quot;, id))&#10;                            // Solo en modo 'manage' notificamos al caller para permitir abrir el gestor de horarios desde flows externos&#10;                            if (mode == &quot;manage&quot;) {&#10;                                try {&#10;                                    onUserSelected(id)&#10;                                } catch (_: Exception) {}&#10;                            }&#10;                        }) {&#10;                            Text(name, style = MaterialTheme.typography.titleMedium)&#10;                            Spacer(Modifier.height(4.dp))&#10;                            Text(if (email.isNotBlank()) &quot;$email · ${role}&quot; else role, style = MaterialTheme.typography.bodySmall)&#10;                        }&#10;                        IconButton(onClick = { actionsOpen = true }) { Icon(Icons.Filled.MoreVert, contentDescription = &quot;Acciones&quot;) }&#10;                    }&#10;                    HorizontalDivider(color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.08f))&#10;                    Spacer(Modifier.height(4.dp))&#10;&#10;                    if (actionsOpen) {&#10;                        // Dialog with user details and actions&#10;                        if (mode == &quot;manage&quot;) {&#10;                            AlertDialog(onDismissRequest = { actionsOpen = false }, title = { Text(name) }, text = {&#10;                                Column {&#10;                                    Text(&quot;Email: $email&quot;)&#10;                                    Spacer(Modifier.height(8.dp))&#10;                                    Text(&quot;Rol: $role&quot;)&#10;                                }&#10;                            }, confirmButton = {&#10;                                Column {&#10;                                    // Agregar horario (principal en manage)&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        val route = com.example.appcolegios.navigation.AppRoutes.AdminScheduleManage.route.replace(&quot;{userId}&quot;, id)&#10;                                        if (navController != null) {&#10;                                            try {&#10;                                                navController.navigate(route)&#10;                                            } catch (e: Exception) {&#10;                                                Toast.makeText(context, &quot;No se pudo abrir gestor de horarios: ${e.message}&quot;, Toast.LENGTH_SHORT).show()&#10;                                            }&#10;                                        } else {&#10;                                            Toast.makeText(context, &quot;NavController no disponible&quot;, Toast.LENGTH_SHORT).show()&#10;                                        }&#10;                                    }) { Icon(Icons.Filled.Schedule, contentDescription = null); Spacer(Modifier.width(6.dp)); Text(&quot;Agregar horario&quot;) }&#10;                                    Spacer(Modifier.height(6.dp))&#10;                                    // Enviar notificación debajo de agregar horario (abre diálogo para componer)&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        composeNotificationForUserId = id&#10;                                        composeNotificationForUserName = name&#10;                                    }) { Icon(Icons.Filled.Notifications, contentDescription = null); Spacer(Modifier.width(6.dp)); Text(&quot;Enviar notificación&quot;) }&#10;                                    Spacer(Modifier.height(6.dp))&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        addEventForUser(db, id, name)&#10;                                    }) { Icon(Icons.Filled.Event, contentDescription = null); Spacer(Modifier.width(6.dp)); Text(&quot;Agregar evento&quot;) }&#10;                                    Spacer(Modifier.height(6.dp))&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        navController?.navigate(com.example.appcolegios.navigation.AppRoutes.AdminProfileDetail.route.replace(&quot;{userId}&quot;, id))&#10;                                    }) { Text(&quot;Ver perfil&quot;) }&#10;                                }&#10;                            }, dismissButton = { TextButton(onClick = { actionsOpen = false }) { Text(&quot;Cerrar&quot;) } })&#10;                        } else {&#10;                            // modo view: solo editar o eliminar&#10;                            AlertDialog(onDismissRequest = { actionsOpen = false }, title = { Text(name) }, text = {&#10;                                Column {&#10;                                    Text(&quot;Email: $email&quot;)&#10;                                    Spacer(Modifier.height(8.dp))&#10;                                    Text(&quot;Rol: $role&quot;)&#10;                                }&#10;                            }, confirmButton = {&#10;                                Row {&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        // editar: navegar a detalle de perfil para edición&#10;                                        navController?.navigate(com.example.appcolegios.navigation.AppRoutes.AdminProfileDetail.route.replace(&quot;{userId}&quot;, id))&#10;                                    }) { Text(&quot;Editar&quot;) }&#10;                                    Spacer(Modifier.width(8.dp))&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        // Abrir diálogo de confirmación&#10;                                        showDeleteConfirmUserId = id&#10;                                        showDeleteConfirmUserName = name&#10;                                    }) { Text(&quot;Eliminar&quot;) }&#10;                                }&#10;                            }, dismissButton = { TextButton(onClick = { actionsOpen = false }) { Text(&quot;Cerrar&quot;) } })&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;        // Delete confirmation dialog&#10;        if (showDeleteConfirmUserId != null) {&#10;            val uidToDelete = showDeleteConfirmUserId&#10;            val uname = showDeleteConfirmUserName ?: &quot;&quot;&#10;            AlertDialog(onDismissRequest = { showDeleteConfirmUserId = null; showDeleteConfirmUserName = null }, title = { Text(&quot;Eliminar usuario&quot;) }, text = { Text(&quot;¿Seguro que deseas eliminar a $uname?&quot;) }, confirmButton = {&#10;                TextButton(onClick = {&#10;                    // realizar borrado&#10;                    scope.launch {&#10;                        try {&#10;                            db.collection(&quot;users&quot;).document(uidToDelete!!).delete().await()&#10;                        } catch (_: Exception) {}&#10;                        try { db.collection(&quot;students&quot;).document(uidToDelete!!).delete().await() } catch (_: Exception) {}&#10;                        try { db.collection(&quot;teachers&quot;).document(uidToDelete!!).delete().await() } catch (_: Exception) {}&#10;                        users = users.filterNot { (it[&quot;id&quot;] as? String) == uidToDelete }&#10;                        Toast.makeText(context, &quot;Usuario eliminado&quot;, Toast.LENGTH_SHORT).show()&#10;                    }&#10;                    showDeleteConfirmUserId = null&#10;                    showDeleteConfirmUserName = null&#10;                }) { Text(&quot;Eliminar&quot;) }&#10;            }, dismissButton = { TextButton(onClick = { showDeleteConfirmUserId = null; showDeleteConfirmUserName = null }) { Text(&quot;Cancelar&quot;) } })&#10;        }&#10;&#10;        // Compose notification dialog&#10;        if (composeNotificationForUserId != null) {&#10;            val uid = composeNotificationForUserId&#10;            val uname = composeNotificationForUserName ?: &quot;&quot;&#10;            AlertDialog(onDismissRequest = { composeNotificationForUserId = null; composeNotificationForUserName = null }, title = { Text(&quot;Enviar notificación a $uname&quot;) }, text = {&#10;                Column {&#10;                    OutlinedTextField(value = notifTitle, onValueChange = { notifTitle = it }, label = { Text(&quot;Título&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                    Spacer(Modifier.height(8.dp))&#10;                    OutlinedTextField(value = notifBody, onValueChange = { notifBody = it }, label = { Text(&quot;Cuerpo&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                }&#10;            }, confirmButton = {&#10;                TextButton(onClick = {&#10;                    // enviar notificación compuesta&#10;                    scope.launch {&#10;                        sendNotificationForUserWithContent(db, uid!!, notifTitle, notifBody)&#10;                        Toast.makeText(context, &quot;Notificación enviada&quot;, Toast.LENGTH_SHORT).show()&#10;                    }&#10;                    // limpiar y cerrar&#10;                    notifTitle = &quot;&quot;&#10;                    notifBody = &quot;&quot;&#10;                    composeNotificationForUserId = null&#10;                    composeNotificationForUserName = null&#10;                }) { Text(&quot;Enviar&quot;) }&#10;            }, dismissButton = { TextButton(onClick = { composeNotificationForUserId = null; composeNotificationForUserName = null }) { Text(&quot;Cancelar&quot;) } })&#10;        }&#10;    }&#10;}&#10;&#10;// Helper: add a minimal event document under users/{userId}/events&#10;private fun addEventForUser(db: FirebaseFirestore, userId: String, titleFallback: String) {&#10;    try {&#10;        val eid = UUID.randomUUID().toString()&#10;        val data = hashMapOf&lt;String, Any?&gt;(&#10;            &quot;id&quot; to eid,&#10;            &quot;title&quot; to &quot;Evento desde Admin&quot;,&#10;            &quot;description&quot; to &quot;Evento agregado por administrador para $titleFallback&quot;,&#10;            &quot;date&quot; to Timestamp.now(),&#10;            &quot;type&quot; to EventType.EVENTO.name,&#10;            &quot;createdAt&quot; to Timestamp.now(),&#10;            &quot;ownerId&quot; to userId&#10;        )&#10;        db.collection(&quot;users&quot;).document(userId).collection(&quot;events&quot;).document(eid).set(data)&#10;        // create notification for the user as well&#10;        val notif = hashMapOf(&#10;            &quot;titulo&quot; to &quot;Nuevo evento&quot;,&#10;            &quot;cuerpo&quot; to &quot;Se agregó un evento a tu calendario&quot;,&#10;            &quot;remitente&quot; to &quot;admin&quot;,&#10;            &quot;senderName&quot; to &quot;Administrador&quot;,&#10;            &quot;fechaHora&quot; to Timestamp.now(),&#10;            &quot;leida&quot; to false,&#10;            &quot;relatedId&quot; to eid,&#10;            &quot;type&quot; to &quot;event&quot;&#10;        )&#10;        db.collection(&quot;users&quot;).document(userId).collection(&quot;notifications&quot;).add(notif)&#10;    } catch (_: Exception) {}&#10;}&#10;&#10;// Send notification with custom title and body content (non-suspending)&#10;private fun sendNotificationForUserWithContent(db: FirebaseFirestore, userId: String, title: String, body: String) {&#10;    try {&#10;        val notif = hashMapOf(&#10;            &quot;titulo&quot; to title,&#10;            &quot;cuerpo&quot; to body,&#10;            &quot;remitente&quot; to &quot;admin&quot;,&#10;            &quot;senderName&quot; to &quot;Administrador&quot;,&#10;            &quot;fechaHora&quot; to Timestamp.now(),&#10;            &quot;leida&quot; to false,&#10;            &quot;type&quot; to &quot;admin&quot;&#10;        )&#10;        // No await here: encolar la escritura y dejar que Firebase la maneje&#10;        db.collection(&quot;users&quot;).document(userId).collection(&quot;notifications&quot;).add(notif)&#10;    } catch (_: Exception) {}&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.appcolegios.admin&#10;&#10;import androidx.navigation.NavController&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.MoreVert&#10;import androidx.compose.material.icons.filled.Notifications&#10;import androidx.compose.material.icons.filled.Event&#10;import androidx.compose.material.icons.filled.Schedule&#10;import com.google.firebase.firestore.FirebaseFirestore&#10;import com.google.firebase.Timestamp&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;import com.example.appcolegios.data.FirebaseRepository&#10;import kotlinx.coroutines.launch&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.TextButton&#10;import androidx.compose.material3.AlertDialog&#10;import androidx.compose.material3.Icon&#10;import com.example.appcolegios.academico.EventType&#10;import java.util.UUID&#10;import androidx.compose.runtime.rememberCoroutineScope&#10;import androidx.compose.ui.platform.LocalContext&#10;import android.widget.Toast&#10;import androidx.compose.material3.OutlinedTextField&#10;import kotlinx.coroutines.tasks.await&#10;&#10;@Composable&#10;fun AdminUsersScreen(navController: NavController? = null, mode: String = &quot;view&quot;, onUserSelected: (String) -&gt; Unit = {}) {&#10;    val db = FirebaseFirestore.getInstance()&#10;    val scope = rememberCoroutineScope()&#10;    val context = LocalContext.current&#10;    var users by remember { mutableStateOf&lt;List&lt;Map&lt;String, Any&gt;&gt;&gt;(emptyList()) }&#10;    var isLoading by remember { mutableStateOf(true) }&#10;    var error by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    // UI states for dialogs&#10;    var showDeleteConfirmUserId by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var showDeleteConfirmUserName by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    var composeNotificationForUserId by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var composeNotificationForUserName by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var notifTitle by remember { mutableStateOf(&quot;&quot;) }&#10;    var notifBody by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    LaunchedEffect(Unit) {&#10;        isLoading = true&#10;        try {&#10;            val repo = FirebaseRepository()&#10;            users = repo.fetchAdminUserList()&#10;        } catch (e: Exception) {&#10;            error = e.message&#10;        } finally {&#10;            isLoading = false&#10;        }&#10;    }&#10;&#10;    if (isLoading) {&#10;        Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) { CircularProgressIndicator() }&#10;        return&#10;    }&#10;    if (error != null) {&#10;        Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) { Text(&quot;Error: $error&quot;) }&#10;        return&#10;    }&#10;&#10;    Card(Modifier.fillMaxSize().padding(8.dp)) {&#10;        // Usar LazyColumn para lista; el contenido del card puede necesitar scroll vertical en pantallas pequeñas&#10;        LazyColumn(contentPadding = PaddingValues(8.dp)) {&#10;            items(users) { u -&gt;&#10;                val id = u[&quot;id&quot;] as? String ?: &quot;&quot;&#10;                val name = (u[&quot;displayName&quot;] as? String) ?: (u[&quot;name&quot;] as? String) ?: &quot;(sin nombre)&quot;&#10;                val email = (u[&quot;email&quot;] as? String) ?: &quot;&quot;&#10;                val role = (u[&quot;role&quot;] as? String) ?: &quot;&quot;&#10;                var actionsOpen by remember { mutableStateOf(false) }&#10;                Column(modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(vertical = 8.dp)&#10;                ) {&#10;                    Row(modifier = Modifier.fillMaxWidth(), verticalAlignment = Alignment.CenterVertically) {&#10;                        Column(modifier = Modifier.weight(1f).clickable {&#10;                            if (mode == &quot;manage&quot;) {&#10;                                // Ir directo a gestionar horario, sin pasar por detalle&#10;                                val route = com.example.appcolegios.navigation.AppRoutes.AdminScheduleManage.route.replace(&quot;{userId}&quot;, id)&#10;                                try { navController?.navigate(route) } catch (_: Exception) {}&#10;                                try { onUserSelected(id) } catch (_: Exception) {}&#10;                            } else {&#10;                                // navegar a detalle de perfil&#10;                                navController?.navigate(com.example.appcolegios.navigation.AppRoutes.AdminProfileDetail.route.replace(&quot;{userId}&quot;, id))&#10;                            }&#10;                        }) {&#10;                            Text(name, style = MaterialTheme.typography.titleMedium)&#10;                            Spacer(Modifier.height(4.dp))&#10;                            Text(if (email.isNotBlank()) &quot;$email · ${role}&quot; else role, style = MaterialTheme.typography.bodySmall)&#10;                        }&#10;                        IconButton(onClick = { actionsOpen = true }) { Icon(Icons.Filled.MoreVert, contentDescription = &quot;Acciones&quot;) }&#10;                    }&#10;                    HorizontalDivider(color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.08f))&#10;                    Spacer(Modifier.height(4.dp))&#10;&#10;                    if (actionsOpen) {&#10;                        // Dialog with user details and actions&#10;                        if (mode == &quot;manage&quot;) {&#10;                            AlertDialog(onDismissRequest = { actionsOpen = false }, title = { Text(name) }, text = {&#10;                                Column {&#10;                                    Text(&quot;Email: $email&quot;)&#10;                                    Spacer(Modifier.height(8.dp))&#10;                                    Text(&quot;Rol: $role&quot;)&#10;                                }&#10;                            }, confirmButton = {&#10;                                Column {&#10;                                    // Agregar horario (principal en manage)&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        val route = com.example.appcolegios.navigation.AppRoutes.AdminScheduleManage.route.replace(&quot;{userId}&quot;, id)&#10;                                        if (navController != null) {&#10;                                            try {&#10;                                                navController.navigate(route)&#10;                                            } catch (e: Exception) {&#10;                                                Toast.makeText(context, &quot;No se pudo abrir gestor de horarios: ${e.message}&quot;, Toast.LENGTH_SHORT).show()&#10;                                            }&#10;                                        } else {&#10;                                            Toast.makeText(context, &quot;NavController no disponible&quot;, Toast.LENGTH_SHORT).show()&#10;                                        }&#10;                                    }) { Icon(Icons.Filled.Schedule, contentDescription = null); Spacer(Modifier.width(6.dp)); Text(&quot;Agregar horario&quot;) }&#10;                                    Spacer(Modifier.height(6.dp))&#10;                                    // Enviar notificación debajo de agregar horario (abre diálogo para componer)&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        composeNotificationForUserId = id&#10;                                        composeNotificationForUserName = name&#10;                                    }) { Icon(Icons.Filled.Notifications, contentDescription = null); Spacer(Modifier.width(6.dp)); Text(&quot;Enviar notificación&quot;) }&#10;                                    Spacer(Modifier.height(6.dp))&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        addEventForUser(db, id, name)&#10;                                    }) { Icon(Icons.Filled.Event, contentDescription = null); Spacer(Modifier.width(6.dp)); Text(&quot;Agregar evento&quot;) }&#10;                                    Spacer(Modifier.height(6.dp))&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        navController?.navigate(com.example.appcolegios.navigation.AppRoutes.AdminProfileDetail.route.replace(&quot;{userId}&quot;, id))&#10;                                    }) { Text(&quot;Ver perfil&quot;) }&#10;                                }&#10;                            }, dismissButton = { TextButton(onClick = { actionsOpen = false }) { Text(&quot;Cerrar&quot;) } })&#10;                        } else {&#10;                            // modo view: solo editar o eliminar&#10;                            AlertDialog(onDismissRequest = { actionsOpen = false }, title = { Text(name) }, text = {&#10;                                Column {&#10;                                    Text(&quot;Email: $email&quot;)&#10;                                    Spacer(Modifier.height(8.dp))&#10;                                    Text(&quot;Rol: $role&quot;)&#10;                                }&#10;                            }, confirmButton = {&#10;                                Row {&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        // editar: navegar a detalle de perfil para edición&#10;                                        navController?.navigate(com.example.appcolegios.navigation.AppRoutes.AdminProfileDetail.route.replace(&quot;{userId}&quot;, id))&#10;                                    }) { Text(&quot;Editar&quot;) }&#10;                                    Spacer(Modifier.width(8.dp))&#10;                                    TextButton(onClick = {&#10;                                        actionsOpen = false&#10;                                        // Abrir diálogo de confirmación&#10;                                        showDeleteConfirmUserId = id&#10;                                        showDeleteConfirmUserName = name&#10;                                    }) { Text(&quot;Eliminar&quot;) }&#10;                                }&#10;                            }, dismissButton = { TextButton(onClick = { actionsOpen = false }) { Text(&quot;Cerrar&quot;) } })&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;        // Delete confirmation dialog&#10;        if (showDeleteConfirmUserId != null) {&#10;            val uidToDelete = showDeleteConfirmUserId&#10;            val uname = showDeleteConfirmUserName ?: &quot;&quot;&#10;            AlertDialog(onDismissRequest = { showDeleteConfirmUserId = null; showDeleteConfirmUserName = null }, title = { Text(&quot;Eliminar usuario&quot;) }, text = { Text(&quot;¿Seguro que deseas eliminar a $uname?&quot;) }, confirmButton = {&#10;                TextButton(onClick = {&#10;                    // realizar borrado&#10;                    scope.launch {&#10;                        try {&#10;                            db.collection(&quot;users&quot;).document(uidToDelete!!).delete().await()&#10;                        } catch (_: Exception) {}&#10;                        try { db.collection(&quot;students&quot;).document(uidToDelete!!).delete().await() } catch (_: Exception) {}&#10;                        try { db.collection(&quot;teachers&quot;).document(uidToDelete!!).delete().await() } catch (_: Exception) {}&#10;                        users = users.filterNot { (it[&quot;id&quot;] as? String) == uidToDelete }&#10;                        Toast.makeText(context, &quot;Usuario eliminado&quot;, Toast.LENGTH_SHORT).show()&#10;                    }&#10;                    showDeleteConfirmUserId = null&#10;                    showDeleteConfirmUserName = null&#10;                }) { Text(&quot;Eliminar&quot;) }&#10;            }, dismissButton = { TextButton(onClick = { showDeleteConfirmUserId = null; showDeleteConfirmUserName = null }) { Text(&quot;Cancelar&quot;) } })&#10;        }&#10;&#10;        // Compose notification dialog&#10;        if (composeNotificationForUserId != null) {&#10;            val uid = composeNotificationForUserId&#10;            val uname = composeNotificationForUserName ?: &quot;&quot;&#10;            AlertDialog(onDismissRequest = { composeNotificationForUserId = null; composeNotificationForUserName = null }, title = { Text(&quot;Enviar notificación a $uname&quot;) }, text = {&#10;                Column {&#10;                    OutlinedTextField(value = notifTitle, onValueChange = { notifTitle = it }, label = { Text(&quot;Título&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                    Spacer(Modifier.height(8.dp))&#10;                    OutlinedTextField(value = notifBody, onValueChange = { notifBody = it }, label = { Text(&quot;Cuerpo&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                }&#10;            }, confirmButton = {&#10;                TextButton(onClick = {&#10;                    // enviar notificación compuesta&#10;                    scope.launch {&#10;                        sendNotificationForUserWithContent(db, uid!!, notifTitle, notifBody)&#10;                        Toast.makeText(context, &quot;Notificación enviada&quot;, Toast.LENGTH_SHORT).show()&#10;                    }&#10;                    // limpiar y cerrar&#10;                    notifTitle = &quot;&quot;&#10;                    notifBody = &quot;&quot;&#10;                    composeNotificationForUserId = null&#10;                    composeNotificationForUserName = null&#10;                }) { Text(&quot;Enviar&quot;) }&#10;            }, dismissButton = { TextButton(onClick = { composeNotificationForUserId = null; composeNotificationForUserName = null }) { Text(&quot;Cancelar&quot;) } })&#10;        }&#10;    }&#10;}&#10;&#10;// Helper: add a minimal event document under users/{userId}/events&#10;private fun addEventForUser(db: FirebaseFirestore, userId: String, titleFallback: String) {&#10;    try {&#10;        val eid = UUID.randomUUID().toString()&#10;        val data = hashMapOf&lt;String, Any?&gt;(&#10;            &quot;id&quot; to eid,&#10;            &quot;title&quot; to &quot;Evento desde Admin&quot;,&#10;            &quot;description&quot; to &quot;Evento agregado por administrador para $titleFallback&quot;,&#10;            &quot;date&quot; to Timestamp.now(),&#10;            &quot;type&quot; to EventType.EVENTO.name,&#10;            &quot;createdAt&quot; to Timestamp.now(),&#10;            &quot;ownerId&quot; to userId&#10;        )&#10;        db.collection(&quot;users&quot;).document(userId).collection(&quot;events&quot;).document(eid).set(data)&#10;        // create notification for the user as well&#10;        val notif = hashMapOf(&#10;            &quot;titulo&quot; to &quot;Nuevo evento&quot;,&#10;            &quot;cuerpo&quot; to &quot;Se agregó un evento a tu calendario&quot;,&#10;            &quot;remitente&quot; to &quot;admin&quot;,&#10;            &quot;senderName&quot; to &quot;Administrador&quot;,&#10;            &quot;fechaHora&quot; to Timestamp.now(),&#10;            &quot;leida&quot; to false,&#10;            &quot;relatedId&quot; to eid,&#10;            &quot;type&quot; to &quot;event&quot;&#10;        )&#10;        db.collection(&quot;users&quot;).document(userId).collection(&quot;notifications&quot;).add(notif)&#10;    } catch (_: Exception) {}&#10;}&#10;&#10;// Send notification with custom title and body content (non-suspending)&#10;private fun sendNotificationForUserWithContent(db: FirebaseFirestore, userId: String, title: String, body: String) {&#10;    try {&#10;        val notif = hashMapOf(&#10;            &quot;titulo&quot; to title,&#10;            &quot;cuerpo&quot; to body,&#10;            &quot;remitente&quot; to &quot;admin&quot;,&#10;            &quot;senderName&quot; to &quot;Administrador&quot;,&#10;            &quot;fechaHora&quot; to Timestamp.now(),&#10;            &quot;leida&quot; to false,&#10;            &quot;type&quot; to &quot;admin&quot;&#10;        )&#10;        // No await here: encolar la escritura y dejar que Firebase la maneje&#10;        db.collection(&quot;users&quot;).document(userId).collection(&quot;notifications&quot;).add(notif)&#10;    } catch (_: Exception) {}&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/appcolegios/auth/RegisterActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/appcolegios/auth/RegisterActivity.kt" />
              <option name="originalContent" value="package com.example.appcolegios.auth&#10;&#10;import android.content.Intent&#10;import android.graphics.Color&#10;import android.os.Bundle&#10;import android.view.View&#10;import android.view.ViewGroup&#10;import android.widget.ArrayAdapter&#10;import android.widget.EditText&#10;import android.widget.Spinner&#10;import android.widget.TextView&#10;import android.widget.Toast&#10;import androidx.appcompat.app.AppCompatActivity&#10;import com.example.appcolegios.R&#10;import com.google.firebase.auth.FirebaseAuth&#10;import com.google.firebase.auth.FirebaseAuthUserCollisionException&#10;import com.google.firebase.FirebaseApp&#10;import com.google.firebase.FirebaseOptions&#10;import com.google.firebase.firestore.FirebaseFirestore&#10;import com.google.android.material.button.MaterialButton&#10;import java.util.Locale&#10;&#10;class RegisterActivity : AppCompatActivity() {&#10;    private lateinit var auth: FirebaseAuth&#10;    private lateinit var db: FirebaseFirestore&#10;&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        setContentView(R.layout.activity_register)&#10;        auth = FirebaseAuth.getInstance()&#10;        db = FirebaseFirestore.getInstance()&#10;&#10;        val fromAdmin = intent.getBooleanExtra(&quot;fromAdmin&quot;, false)&#10;&#10;        val nameInput: EditText = findViewById(R.id.nameInput)&#10;        val emailInput: EditText = findViewById(R.id.emailInput)&#10;        val documentInput: EditText = findViewById(R.id.documentInput)&#10;        val phoneInput: EditText = findViewById(R.id.phoneInput)&#10;        val passwordInput: EditText = findViewById(R.id.passwordInput)&#10;        val confirmInput: EditText = findViewById(R.id.confirmPasswordInput)&#10;        val roleSpinner: Spinner = findViewById(R.id.roleSpinner)&#10;        val registerButton: MaterialButton = findViewById(R.id.registerButton)&#10;&#10;        // Si viene de admin permitir seleccionar ADMIN y ocultar campos de contraseña opcionalmente&#10;        val roles = if (fromAdmin) listOf(&quot;ESTUDIANTE&quot;, &quot;PADRE&quot;, &quot;DOCENTE&quot;, &quot;ADMIN&quot;) else listOf(&quot;ESTUDIANTE&quot;, &quot;PADRE&quot;, &quot;DOCENTE&quot;)&#10;&#10;        // Adapter personalizado para forzar color de texto (evita que las letras salgan en blanco en temas oscuros)&#10;        val adapter = object : ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_spinner_item, roles) {&#10;            override fun getView(position: Int, convertView: View?, parent: ViewGroup): View {&#10;                val v = super.getView(position, convertView, parent) as TextView&#10;                v.setTextColor(Color.BLACK)&#10;                return v&#10;            }&#10;&#10;            override fun getDropDownView(position: Int, convertView: View?, parent: ViewGroup): View {&#10;                val v = super.getDropDownView(position, convertView, parent) as TextView&#10;                v.setTextColor(Color.BLACK)&#10;                return v&#10;            }&#10;        }&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)&#10;        roleSpinner.adapter = adapter&#10;&#10;        // Si es desde admin no mostramos la confirmación de contraseña y password puede ser opcional&#10;        if (fromAdmin) {&#10;            // No ocultar los campos para que no parezcan &quot;no funcionales&quot;.&#10;            // Sólo avisamos con el hint de que la contraseña no se almacenará en este modo.&#10;            passwordInput.hint = &quot;Opcional (si se deja vacío se encola para backend)&quot;&#10;            confirmInput.hint = &quot;Opcional&quot;&#10;        }&#10;&#10;        registerButton.setOnClickListener {&#10;            val name = nameInput.text.toString().trim()&#10;            val email = emailInput.text.toString().trim()&#10;            val document = documentInput.text.toString().trim()&#10;            val phone = phoneInput.text.toString().trim()&#10;            val password = passwordInput.text.toString().trim()&#10;            val confirm = confirmInput.text.toString().trim()&#10;            // Obtener rol seleccionado y normalizar a mayúsculas; si está vacío, asumir ADMIN&#10;            val rawRole = roles.getOrNull(roleSpinner.selectedItemPosition)&#10;            val role = rawRole?.uppercase(Locale.ROOT) ?: &quot;ADMIN&quot;&#10;&#10;            if (name.isEmpty() || email.isEmpty() || document.isEmpty() || phone.isEmpty() || (!fromAdmin &amp;&amp; (password.isEmpty() || confirm.isEmpty()))) {&#10;                Toast.makeText(this, &quot;Todos los campos son obligatorios&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;            if (!fromAdmin &amp;&amp; (password.length &lt; 6 || password != confirm)) {&#10;                Toast.makeText(this, &quot;Contraseñas inválidas&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;&#10;            if (fromAdmin) {&#10;                // Intentamos crear la cuenta en Firebase Auth usando una FirebaseApp secundaria&#10;                // para no afectar la sesión del admin.&#10;                try {&#10;                    val opts = FirebaseOptions.fromResource(this)&#10;                    val importerApp = if (opts != null) {&#10;                        try {&#10;                            FirebaseApp.getInstance(&quot;importer&quot;)&#10;                        } catch (_: IllegalStateException) {&#10;                            FirebaseApp.initializeApp(this, opts, &quot;importer&quot;)&#10;                        }&#10;                    } else {&#10;                        null&#10;                    }&#10;&#10;                    val authImporter = if (importerApp != null) FirebaseAuth.getInstance(importerApp) else FirebaseAuth.getInstance()&#10;&#10;                    if (password.isNotEmpty()) {&#10;                        // Crear usuario en Auth (en la app importadora si fue posible)&#10;                        authImporter.createUserWithEmailAndPassword(email, password)&#10;                            .addOnSuccessListener { result -&gt;&#10;                                val uid = result.user?.uid&#10;                                val data = mapOf(&#10;                                    &quot;name&quot; to name,&#10;                                    &quot;email&quot; to email,&#10;                                    &quot;document&quot; to document,&#10;                                    &quot;phone&quot; to phone,&#10;                                    &quot;role&quot; to role,&#10;                                    &quot;createdAt&quot; to com.google.firebase.Timestamp.now()&#10;                                )&#10;                                val coll = when (role) {&#10;                                    &quot;PADRE&quot; -&gt; &quot;parents&quot;&#10;                                    &quot;DOCENTE&quot; -&gt; &quot;teachers&quot;&#10;                                    &quot;ADMIN&quot; -&gt; &quot;admins&quot;&#10;                                    else -&gt; &quot;students&quot;&#10;                                }&#10;                                // Guardar documento asociado&#10;                                db.collection(coll).document(uid ?: db.collection(coll).document().id)&#10;                                    .set(data)&#10;                                    .addOnSuccessListener {&#10;                                        // Enviar verificación desde authImporter (no afecta admin)&#10;                                        try {&#10;                                            authImporter.currentUser?.sendEmailVerification()&#10;                                        } catch (_: Exception) {}&#10;&#10;                                        // Crear también documento en 'users' para que la app reconozca el rol y email&#10;                                        try {&#10;                                            val userMap = mapOf(&#10;                                                &quot;displayName&quot; to name,&#10;                                                &quot;email&quot; to email,&#10;                                                &quot;role&quot; to role&#10;                                            )&#10;                                            db.collection(&quot;users&quot;).document(uid ?: db.collection(&quot;users&quot;).document().id)&#10;                                                .set(userMap)&#10;                                        } catch (_: Exception) {}&#10;&#10;                                        // Cerrar sesión en importer para limpiar&#10;                                        try { authImporter.signOut() } catch (_: Exception) {}&#10;&#10;                                        Toast.makeText(this, &quot;Usuario creado correctamente (Auth + Firestore)&quot;, Toast.LENGTH_LONG).show()&#10;                                        finish()&#10;                                    }&#10;                                    .addOnFailureListener { e -&gt;&#10;                                        Toast.makeText(this, &quot;Error guardando documento: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                                    }&#10;                            }&#10;                            .addOnFailureListener { e -&gt;&#10;                                if (e is FirebaseAuthUserCollisionException) {&#10;                                    Toast.makeText(this, &quot;El correo ya está registrado.&quot;, Toast.LENGTH_LONG).show()&#10;                                } else {&#10;                                    Toast.makeText(this, &quot;Error creando usuario en Auth: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                                }&#10;                            }&#10;                    } else {&#10;                        // Si no se especifica contraseña, encolamos la petición para backend (auth_queue)&#10;                        val queueData = mapOf(&#10;                            &quot;email&quot; to email,&#10;                            &quot;role&quot; to role,&#10;                            &quot;displayName&quot; to name,&#10;                            &quot;requestedAt&quot; to com.google.firebase.Timestamp.now()&#10;                        )&#10;                        val coll = when (role) {&#10;                            &quot;PADRE&quot; -&gt; &quot;parents&quot;&#10;                            &quot;DOCENTE&quot; -&gt; &quot;teachers&quot;&#10;                            &quot;ADMIN&quot; -&gt; &quot;admins&quot;&#10;                            else -&gt; &quot;students&quot;&#10;                        }&#10;                        db.collection(coll).add(mapOf(&#10;                            &quot;name&quot; to name,&#10;                            &quot;email&quot; to email,&#10;                            &quot;document&quot; to document,&#10;                            &quot;phone&quot; to phone,&#10;                            &quot;role&quot; to role,&#10;                            &quot;createdAt&quot; to com.google.firebase.Timestamp.now()&#10;                        )).addOnSuccessListener {&#10;                            db.collection(&quot;auth_queue&quot;).add(queueData)&#10;                                .addOnSuccessListener {&#10;                                    // Crear también doc en 'users' para que la app conozca el correo/rol&#10;                                    try {&#10;                                        val userMap = mapOf(&#10;                                            &quot;displayName&quot; to name,&#10;                                            &quot;email&quot; to email,&#10;                                            &quot;role&quot; to role,&#10;                                            &quot;importedAt&quot; to com.google.firebase.Timestamp.now()&#10;                                        )&#10;                                        db.collection(&quot;users&quot;).add(userMap)&#10;                                    } catch (_: Exception) {}&#10;&#10;                                    Toast.makeText(this, &quot;Usuario creado en Firestore y encolado para Auth (backend)&quot;, Toast.LENGTH_LONG).show()&#10;                                    finish()&#10;                                }&#10;                                .addOnFailureListener { e -&gt;&#10;                                    Toast.makeText(this, &quot;Error encolando para Auth: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                                }&#10;                        }.addOnFailureListener { e -&gt;&#10;                            Toast.makeText(this, &quot;Error guardando documento: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                        }&#10;                    }&#10;&#10;                } catch (e: Exception) {&#10;                    Toast.makeText(this, &quot;Error inicializando importador Auth: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                }&#10;&#10;            } else {&#10;                // Flujo normal: registrar en FirebaseAuth y crear documento en Firestore luego cerrar sesión y volver al login&#10;                auth.createUserWithEmailAndPassword(email, password)&#10;                    .addOnSuccessListener { result -&gt;&#10;                        val uid = result.user?.uid ?: return@addOnSuccessListener&#10;                        val data = mapOf(&#10;                            &quot;name&quot; to name,&#10;                            &quot;email&quot; to email,&#10;                            &quot;document&quot; to document,&#10;                            &quot;phone&quot; to phone,&#10;                            &quot;role&quot; to role&#10;                        )&#10;                        db.collection(&quot;users&quot;).document(uid).set(data)&#10;                            .addOnCompleteListener {&#10;                                // Mantener comportamiento previo: desloguear y volver al login&#10;                                auth.signOut()&#10;                                Toast.makeText(this, &quot;Cuenta creada. Inicia sesión.&quot;, Toast.LENGTH_LONG).show()&#10;                                startActivity(Intent(this, LoginActivity::class.java))&#10;                                finish()&#10;                            }&#10;                    }&#10;                    .addOnFailureListener { e -&gt;&#10;                        Toast.makeText(this, &quot;Error: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                    }&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.appcolegios.auth&#10;&#10;import android.content.Intent&#10;import android.graphics.Color&#10;import android.os.Bundle&#10;import android.view.View&#10;import android.view.ViewGroup&#10;import android.widget.ArrayAdapter&#10;import android.widget.EditText&#10;import android.widget.Spinner&#10;import android.widget.TextView&#10;import android.widget.Toast&#10;import androidx.appcompat.app.AppCompatActivity&#10;import com.example.appcolegios.R&#10;import com.google.firebase.auth.FirebaseAuth&#10;import com.google.firebase.auth.FirebaseAuthUserCollisionException&#10;import com.google.firebase.FirebaseApp&#10;import com.google.firebase.FirebaseOptions&#10;import com.google.firebase.firestore.FirebaseFirestore&#10;import com.google.android.material.button.MaterialButton&#10;import java.util.Locale&#10;&#10;class RegisterActivity : AppCompatActivity() {&#10;    private lateinit var auth: FirebaseAuth&#10;    private lateinit var db: FirebaseFirestore&#10;&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        setContentView(R.layout.activity_register)&#10;        auth = FirebaseAuth.getInstance()&#10;        db = FirebaseFirestore.getInstance()&#10;&#10;        val fromAdmin = intent.getBooleanExtra(&quot;fromAdmin&quot;, false)&#10;&#10;        val nameInput: EditText = findViewById(R.id.nameInput)&#10;        val emailInput: EditText = findViewById(R.id.emailInput)&#10;        val documentInput: EditText = findViewById(R.id.documentInput)&#10;        val phoneInput: EditText = findViewById(R.id.phoneInput)&#10;        val passwordInput: EditText = findViewById(R.id.passwordInput)&#10;        val confirmInput: EditText = findViewById(R.id.confirmPasswordInput)&#10;        val roleSpinner: Spinner = findViewById(R.id.roleSpinner)&#10;        val registerButton: MaterialButton = findViewById(R.id.registerButton)&#10;&#10;        // Si viene de admin permitir seleccionar ADMIN y ocultar campos de contraseña opcionalmente&#10;        val roles = if (fromAdmin) listOf(&quot;ESTUDIANTE&quot;, &quot;PADRE&quot;, &quot;DOCENTE&quot;, &quot;ADMIN&quot;) else listOf(&quot;ESTUDIANTE&quot;, &quot;PADRE&quot;, &quot;DOCENTE&quot;)&#10;&#10;        // Adapter personalizado para forzar color de texto (evita que las letras salgan en blanco en temas oscuros)&#10;        val adapter = object : ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_spinner_item, roles) {&#10;            override fun getView(position: Int, convertView: View?, parent: ViewGroup): View {&#10;                val v = super.getView(position, convertView, parent) as TextView&#10;                v.setTextColor(Color.BLACK)&#10;                return v&#10;            }&#10;&#10;            override fun getDropDownView(position: Int, convertView: View?, parent: ViewGroup): View {&#10;                val v = super.getDropDownView(position, convertView, parent) as TextView&#10;                v.setTextColor(Color.BLACK)&#10;                return v&#10;            }&#10;        }&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)&#10;        roleSpinner.adapter = adapter&#10;&#10;        // Si es desde admin no mostramos la confirmación de contraseña y password puede ser opcional&#10;        if (fromAdmin) {&#10;            // Ocultar por completo TextInputLayout de contraseña y confirmación&#10;            (passwordInput.parent as? View)?.visibility = View.GONE&#10;            (confirmInput.parent as? View)?.visibility = View.GONE&#10;        }&#10;&#10;        registerButton.setOnClickListener {&#10;            val name = nameInput.text.toString().trim()&#10;            val email = emailInput.text.toString().trim()&#10;            val document = documentInput.text.toString().trim()&#10;            val phone = phoneInput.text.toString().trim()&#10;            val password = passwordInput.text.toString().trim()&#10;            val confirm = confirmInput.text.toString().trim()&#10;            // Obtener rol seleccionado y normalizar a mayúsculas; si está vacío, asumir ADMIN&#10;            val rawRole = roles.getOrNull(roleSpinner.selectedItemPosition)&#10;            val role = rawRole?.uppercase(Locale.ROOT) ?: &quot;ADMIN&quot;&#10;&#10;            if (name.isEmpty() || email.isEmpty() || document.isEmpty() || phone.isEmpty() || (!fromAdmin &amp;&amp; (password.isEmpty() || confirm.isEmpty()))) {&#10;                Toast.makeText(this, &quot;Todos los campos son obligatorios&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;            if (!fromAdmin &amp;&amp; (password.length &lt; 6 || password != confirm)) {&#10;                Toast.makeText(this, &quot;Contraseñas inválidas&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;&#10;            if (fromAdmin) {&#10;                // Intentamos crear la cuenta en Firebase Auth usando una FirebaseApp secundaria&#10;                // para no afectar la sesión del admin.&#10;                try {&#10;                    val opts = FirebaseOptions.fromResource(this)&#10;                    val importerApp = if (opts != null) {&#10;                        try {&#10;                            FirebaseApp.getInstance(&quot;importer&quot;)&#10;                        } catch (_: IllegalStateException) {&#10;                            FirebaseApp.initializeApp(this, opts, &quot;importer&quot;)&#10;                        }&#10;                    } else {&#10;                        null&#10;                    }&#10;&#10;                    val authImporter = if (importerApp != null) FirebaseAuth.getInstance(importerApp) else FirebaseAuth.getInstance()&#10;&#10;                    if (password.isNotEmpty()) {&#10;                        // Crear usuario en Auth (en la app importadora si fue posible)&#10;                        authImporter.createUserWithEmailAndPassword(email, password)&#10;                            .addOnSuccessListener { result -&gt;&#10;                                val uid = result.user?.uid&#10;                                val data = mapOf(&#10;                                    &quot;name&quot; to name,&#10;                                    &quot;email&quot; to email,&#10;                                    &quot;document&quot; to document,&#10;                                    &quot;phone&quot; to phone,&#10;                                    &quot;role&quot; to role,&#10;                                    &quot;createdAt&quot; to com.google.firebase.Timestamp.now()&#10;                                )&#10;                                val coll = when (role) {&#10;                                    &quot;PADRE&quot; -&gt; &quot;parents&quot;&#10;                                    &quot;DOCENTE&quot; -&gt; &quot;teachers&quot;&#10;                                    &quot;ADMIN&quot; -&gt; &quot;admins&quot;&#10;                                    else -&gt; &quot;students&quot;&#10;                                }&#10;                                // Guardar documento asociado&#10;                                db.collection(coll).document(uid ?: db.collection(coll).document().id)&#10;                                    .set(data)&#10;                                    .addOnSuccessListener {&#10;                                        // Enviar verificación desde authImporter (no afecta admin)&#10;                                        try {&#10;                                            authImporter.currentUser?.sendEmailVerification()&#10;                                        } catch (_: Exception) {}&#10;&#10;                                        // Crear también documento en 'users' para que la app reconozca el rol y email&#10;                                        try {&#10;                                            val userMap = mapOf(&#10;                                                &quot;displayName&quot; to name,&#10;                                                &quot;email&quot; to email,&#10;                                                &quot;role&quot; to role&#10;                                            )&#10;                                            db.collection(&quot;users&quot;).document(uid ?: db.collection(&quot;users&quot;).document().id)&#10;                                                .set(userMap)&#10;                                        } catch (_: Exception) {}&#10;&#10;                                        // Cerrar sesión en importer para limpiar&#10;                                        try { authImporter.signOut() } catch (_: Exception) {}&#10;&#10;                                        Toast.makeText(this, &quot;Usuario creado correctamente (Auth + Firestore)&quot;, Toast.LENGTH_LONG).show()&#10;                                        finish()&#10;                                    }&#10;                                    .addOnFailureListener { e -&gt;&#10;                                        Toast.makeText(this, &quot;Error guardando documento: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                                    }&#10;                            }&#10;                            .addOnFailureListener { e -&gt;&#10;                                if (e is FirebaseAuthUserCollisionException) {&#10;                                    Toast.makeText(this, &quot;El correo ya está registrado.&quot;, Toast.LENGTH_LONG).show()&#10;                                } else {&#10;                                    Toast.makeText(this, &quot;Error creando usuario en Auth: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                                }&#10;                            }&#10;                    } else {&#10;                        // Si no se especifica contraseña, encolamos la petición para backend (auth_queue)&#10;                        val queueData = mapOf(&#10;                            &quot;email&quot; to email,&#10;                            &quot;role&quot; to role,&#10;                            &quot;displayName&quot; to name,&#10;                            &quot;requestedAt&quot; to com.google.firebase.Timestamp.now()&#10;                        )&#10;                        val coll = when (role) {&#10;                            &quot;PADRE&quot; -&gt; &quot;parents&quot;&#10;                            &quot;DOCENTE&quot; -&gt; &quot;teachers&quot;&#10;                            &quot;ADMIN&quot; -&gt; &quot;admins&quot;&#10;                            else -&gt; &quot;students&quot;&#10;                        }&#10;                        db.collection(coll).add(mapOf(&#10;                            &quot;name&quot; to name,&#10;                            &quot;email&quot; to email,&#10;                            &quot;document&quot; to document,&#10;                            &quot;phone&quot; to phone,&#10;                            &quot;role&quot; to role,&#10;                            &quot;createdAt&quot; to com.google.firebase.Timestamp.now()&#10;                        )).addOnSuccessListener {&#10;                            db.collection(&quot;auth_queue&quot;).add(queueData)&#10;                                .addOnSuccessListener {&#10;                                    // Crear también doc en 'users' para que la app conozca el correo/rol&#10;                                    try {&#10;                                        val userMap = mapOf(&#10;                                            &quot;displayName&quot; to name,&#10;                                            &quot;email&quot; to email,&#10;                                            &quot;role&quot; to role,&#10;                                            &quot;importedAt&quot; to com.google.firebase.Timestamp.now()&#10;                                        )&#10;                                        db.collection(&quot;users&quot;).add(userMap)&#10;                                    } catch (_: Exception) {}&#10;&#10;                                    Toast.makeText(this, &quot;Usuario creado en Firestore y encolado para Auth (backend)&quot;, Toast.LENGTH_LONG).show()&#10;                                    finish()&#10;                                }&#10;                                .addOnFailureListener { e -&gt;&#10;                                    Toast.makeText(this, &quot;Error encolando para Auth: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                                }&#10;                        }.addOnFailureListener { e -&gt;&#10;                            Toast.makeText(this, &quot;Error guardando documento: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                        }&#10;                    }&#10;&#10;                } catch (e: Exception) {&#10;                    Toast.makeText(this, &quot;Error inicializando importador Auth: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                }&#10;&#10;            } else {&#10;                // Flujo normal: registrar en FirebaseAuth y crear documento en Firestore luego cerrar sesión y volver al login&#10;                auth.createUserWithEmailAndPassword(email, password)&#10;                    .addOnSuccessListener { result -&gt;&#10;                        val uid = result.user?.uid ?: return@addOnSuccessListener&#10;                        val data = mapOf(&#10;                            &quot;name&quot; to name,&#10;                            &quot;email&quot; to email,&#10;                            &quot;document&quot; to document,&#10;                            &quot;phone&quot; to phone,&#10;                            &quot;role&quot; to role&#10;                        )&#10;                        db.collection(&quot;users&quot;).document(uid).set(data)&#10;                            .addOnCompleteListener {&#10;                                // Mantener comportamiento previo: desloguear y volver al login&#10;                                auth.signOut()&#10;                                Toast.makeText(this, &quot;Cuenta creada. Inicia sesión.&quot;, Toast.LENGTH_LONG).show()&#10;                                startActivity(Intent(this, LoginActivity::class.java))&#10;                                finish()&#10;                            }&#10;                    }&#10;                    .addOnFailureListener { e -&gt;&#10;                        Toast.makeText(this, &quot;Error: ${e.localizedMessage}&quot;, Toast.LENGTH_LONG).show()&#10;                    }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/appcolegios/ui/AnimatedMaterialButton.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/appcolegios/ui/AnimatedMaterialButton.kt" />
              <option name="updatedContent" value="package com.example.appcolegios.ui&#10;&#10;import android.content.Context&#10;import android.util.AttributeSet&#10;import android.view.MotionEvent&#10;import com.google.android.material.button.MaterialButton&#10;&#10;class AnimatedMaterialButton @JvmOverloads constructor(&#10;    context: Context,&#10;    attrs: AttributeSet? = null,&#10;    defStyleAttr: Int = com.google.android.material.R.attr.materialButtonStyle&#10;) : MaterialButton(context, attrs, defStyleAttr) {&#10;&#10;    override fun onTouchEvent(event: MotionEvent): Boolean {&#10;        when (event.action) {&#10;            MotionEvent.ACTION_DOWN -&gt; {&#10;                this.animate().scaleX(0.97f).scaleY(0.97f).setDuration(50).start()&#10;            }&#10;            MotionEvent.ACTION_UP, MotionEvent.ACTION_CANCEL -&gt; {&#10;                this.animate().scaleX(1f).scaleY(1f).setDuration(50).start()&#10;            }&#10;        }&#10;        return super.onTouchEvent(event)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/anim/fade_in.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/anim/fade_in.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;alpha xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:duration=&quot;300&quot;&#10;    android:fromAlpha=&quot;0.0&quot;&#10;    android:toAlpha=&quot;1.0&quot; /&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/activity_register.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/activity_register.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:background=&quot;@color/background&quot;&#10;    android:fillViewport=&quot;true&quot;&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:orientation=&quot;vertical&quot;&#10;        android:padding=&quot;24dp&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:gravity=&quot;center&quot;&gt;&#10;&#10;        &lt;!-- Logo Institucional --&gt;&#10;        &lt;ImageView&#10;            android:id=&quot;@+id/logoImage&quot;&#10;            android:layout_width=&quot;120dp&quot;&#10;            android:layout_height=&quot;120dp&quot;&#10;            android:layout_gravity=&quot;center&quot;&#10;            android:layout_marginBottom=&quot;24dp&quot;&#10;            android:src=&quot;@drawable/logo&quot;&#10;            android:contentDescription=&quot;@string/app_name&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/create_account&quot;&#10;            android:textSize=&quot;24sp&quot;&#10;            android:textColor=&quot;@color/on_background&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:layout_marginBottom=&quot;32dp&quot; /&gt;&#10;&#10;        &lt;!-- Card contenedor de campos --&gt;&#10;        &lt;com.google.android.material.card.MaterialCardView&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginBottom=&quot;24dp&quot;&#10;            app:cardBackgroundColor=&quot;@color/surface&quot;&#10;            app:cardElevation=&quot;4dp&quot;&#10;            app:cardCornerRadius=&quot;16dp&quot;&gt;&#10;&#10;            &lt;LinearLayout&#10;                android:orientation=&quot;vertical&quot;&#10;                android:padding=&quot;20dp&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/nameInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/name&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textPersonName&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/emailInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/email&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textEmailAddress&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/documentInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/document&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;text&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/phoneInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/phone&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;phone&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&#10;                    app:passwordToggleEnabled=&quot;true&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/passwordInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/password&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textPassword&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&#10;                    app:passwordToggleEnabled=&quot;true&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/confirmPasswordInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/confirm_password&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textPassword&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;!-- Spinner de Rol --&gt;&#10;                &lt;TextView&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    android:text=&quot;@string/select_role&quot;&#10;                    android:textColor=&quot;@color/on_surface&quot;&#10;                    android:textSize=&quot;12sp&quot; /&gt;&#10;&#10;                &lt;Spinner&#10;                    android:id=&quot;@+id/roleSpinner&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;8dp&quot;&#10;                    android:minHeight=&quot;48dp&quot; /&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;        &lt;/com.google.android.material.card.MaterialCardView&gt;&#10;&#10;        &lt;!-- Botón principal --&gt;&#10;        &lt;com.example.appcolegios.ui.AnimatedMaterialButton&#10;            android:id=&quot;@+id/registerButton&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;60dp&quot;&#10;            android:text=&quot;@string/create_account&quot;&#10;            android:textSize=&quot;16sp&quot;&#10;            app:backgroundTint=&quot;@color/primary&quot;&#10;            app:cornerRadius=&quot;12dp&quot;&#10;            app:elevation=&quot;2dp&quot; /&gt;&#10;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&lt;/ScrollView&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:background=&quot;@color/background&quot;&#10;    android:fillViewport=&quot;true&quot;&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:orientation=&quot;vertical&quot;&#10;        android:padding=&quot;24dp&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:gravity=&quot;center&quot;&gt;&#10;&#10;        &lt;!-- Logo Institucional --&gt;&#10;        &lt;ImageView&#10;            android:id=&quot;@+id/logoImage&quot;&#10;            android:layout_width=&quot;120dp&quot;&#10;            android:layout_height=&quot;120dp&quot;&#10;            android:layout_gravity=&quot;center&quot;&#10;            android:layout_marginBottom=&quot;24dp&quot;&#10;            android:src=&quot;@drawable/logo&quot;&#10;            android:contentDescription=&quot;@string/app_name&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/create_account&quot;&#10;            android:textSize=&quot;24sp&quot;&#10;            android:textColor=&quot;@color/on_background&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:layout_marginBottom=&quot;32dp&quot; /&gt;&#10;&#10;        &lt;!-- Card contenedor de campos --&gt;&#10;        &lt;com.google.android.material.card.MaterialCardView&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginBottom=&quot;24dp&quot;&#10;            app:cardBackgroundColor=&quot;@color/surface&quot;&#10;            app:cardElevation=&quot;4dp&quot;&#10;            app:cardCornerRadius=&quot;16dp&quot;&gt;&#10;&#10;            &lt;LinearLayout&#10;                android:orientation=&quot;vertical&quot;&#10;                android:padding=&quot;20dp&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/nameInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/name&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textPersonName&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/emailInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/email&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textEmailAddress&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/documentInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/document&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;text&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/phoneInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/phone&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;phone&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:id=&quot;@+id/passwordLayout&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&#10;                    app:passwordToggleEnabled=&quot;true&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/passwordInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/password&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textPassword&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputLayout&#10;                    android:id=&quot;@+id/confirmPasswordLayout&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    app:boxStrokeColor=&quot;@color/primary&quot;&#10;                    app:hintTextColor=&quot;@color/on_surface_variant&quot;&#10;                    app:passwordToggleEnabled=&quot;true&quot;&gt;&#10;&#10;                    &lt;com.google.android.material.textfield.TextInputEditText&#10;                        android:id=&quot;@+id/confirmPasswordInput&quot;&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:hint=&quot;@string/confirm_password&quot;&#10;                        android:textColor=&quot;@color/on_surface&quot;&#10;                        android:textColorHint=&quot;@color/on_surface_variant&quot;&#10;                        android:inputType=&quot;textPassword&quot; /&gt;&#10;                &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;                &lt;!-- Spinner de Rol --&gt;&#10;                &lt;TextView&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;16dp&quot;&#10;                    android:text=&quot;@string/select_role&quot;&#10;                    android:textColor=&quot;@color/on_surface&quot;&#10;                    android:textSize=&quot;12sp&quot; /&gt;&#10;&#10;                &lt;Spinner&#10;                    android:id=&quot;@+id/roleSpinner&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_marginTop=&quot;8dp&quot;&#10;                    android:minHeight=&quot;48dp&quot; /&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;        &lt;/com.google.android.material.card.MaterialCardView&gt;&#10;&#10;        &lt;!-- Botón principal --&gt;&#10;        &lt;com.example.appcolegios.ui.AnimatedMaterialButton&#10;            android:id=&quot;@+id/registerButton&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;60dp&quot;&#10;            android:text=&quot;@string/create_account&quot;&#10;            android:textSize=&quot;16sp&quot;&#10;            app:backgroundTint=&quot;@color/primary&quot;&#10;            app:cornerRadius=&quot;12dp&quot;&#10;            app:elevation=&quot;2dp&quot; /&gt;&#10;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&lt;/ScrollView&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>